- name: Test connectivity to Cisco switch
  hosts: switches
  gather_facts: no
  tasks:
    - name: Test if the switch is reachable
      ansible.builtin.ping:
      vars:
        ansible_ssh_common_args: '-o KexAlgorithms=+diffie-hellman-group14-sha1 -o Ciphers=+aes128-cbc,aes256-cbc'

    - name: Run 'show version' command on the switch
      cisco.ios.ios_command:
        commands:
          - show version
      register: result

    - name: Display the result
      debug:
        var: result
